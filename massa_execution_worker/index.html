<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="General description"><title>massa_execution_worker - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-e5308b57e507db71.css" id="mainThemeStyle"><link rel="stylesheet" id="themeStyle" href="../static.files/light-d59023bfa12059d2.css"><link rel="stylesheet" disabled href="../static.files/dark-1ca41bb1e10af075.css"><link rel="stylesheet" disabled href="../static.files/ayu-18b4181a2f3fb862.css"><script src="../static.files/storage-3891ce972e3a2bf8.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-98a684e84ae5b08b.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../massa_execution_worker/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../massa_execution_worker/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Crate massa_execution_worker</a></h2><div class="sidebar-elems"><ul class="block"><li class="version">Version 0.1.0</li><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#functions">Functions</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Crate <a class="mod" href="#">massa_execution_worker</a><button id="copy-path" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../src/massa_execution_worker/lib.rs.html#3-117">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h2 id="general-description"><a href="#general-description">General description</a></h2>
<p>The execution worker launches a persistent thread allowing the execution
of operations that can contain executable bytecode and managing interactions with the ledger.
When the worker is launched, a <code>ExecutionManager</code> and a <code>ExecutionController</code> are returned.
<code>ExecutionManager</code> allows stopping the worker,
and <code>ExecutionController</code> is the clonable structure through which users interact with the worker.</p>
<p>The worker is fed through the <code>ExecutionController</code> with information about blockclique changes and newly finalized blocks
and will execute the operations in those blocks, as well as pending asynchronous operations on empty slots.
The worker can also query the current state of the ledger, and simulate operations in a read-only context.</p>
<p>The execution worker has shared read access to the final ledger,
and must be the only module with runtime write access to the final ledger.</p>
<h2 id="a-note-on-finality"><a href="#a-note-on-finality">A note on finality</a></h2>
<p>The operations contained in a final slot are ready to be executed as final
only once all the previous slots are final and their operations are executed as final or ready to be so.
This ensures the sequential order of the final executions of operations,
thus ensuring that writes to the final ledger are irreversible.</p>
<p>Slots are called “active” if they have not been executed as final, and are not ready to be executed as final.
Active slots can therefore be final slots, or slots containing blocks from the blockclique, or empty (miss) slots.
Active slots can be executed in a speculative way: their execution might need to be reverted
as new blocks finalize or arrive, causing changes to them or to active slots before them.</p>
<p>Miss slots are executed as well because they can contain implicit and asynchronous operations.</p>
<h2 id="architecture"><a href="#architecture">Architecture</a></h2>
<p>This crate is meant to be included only at the binary level to launch the worker,
not by the lib crates that will interact with it.
It depends on the massa-execution-exports crate that contains all the publicly exposed elements
and through which users will actually interact with the worker.</p>
<h3 id="workerrs"><a href="#workerrs">worker.rs</a></h3>
<p>This module runs the main loop of the worker thread.
It contains the logic to process incoming blockclique change notifications and read-only execution requests.
It sequences the blocks according to their slot number into queues,
and requests the execution of active and final slots to execution.rs.</p>
<h3 id="slot_sequencerrs"><a href="#slot_sequencerrs">slot_sequencer.rs</a></h3>
<p>Implements <code>SlotSequencer</code>
that allows sequencing slots for execution.</p>
<h3 id="controllerrs"><a href="#controllerrs">controller.rs</a></h3>
<p>Implements <code>ExecutionManager</code> and <code>ExecutionController</code>
that serve as interfaces for users to interact with the worker in worker.rs.</p>
<h3 id="executionrs"><a href="#executionrs">execution.rs</a></h3>
<p>Contains the machinery to execute final and non-final slots,
and track the state and results of those executions.
This module initializes and holds a reference to the interface from <code>interface_impl.rs</code>
that allows the crate to provide execution state access
to the virtual machine runtime (massa-sc-runtime crate).
It also serves as an access point to the current execution state and speculative ledger
as defined in <code>speculative_ledger.rs</code>.</p>
<h3 id="speculative_ledgerrs"><a href="#speculative_ledgerrs"><code>speculative_ledger.rs</code></a></h3>
<p>A speculative (non-final) ledger that supports canceling already-executed operations
in the case of some blockclique changes.</p>
<h3 id="speculative_executed_opsrs"><a href="#speculative_executed_opsrs"><code>speculative_executed_ops.rs</code></a></h3>
<p>A speculative (non-final) list of previously executed operations to prevent reuse.</p>
<h3 id="request_queuers"><a href="#request_queuers"><code>request_queue.rs</code></a></h3>
<p>This module contains the implementation of a generic finite-size execution request queue.
It handles requests that come with an MPSC to send back the result of their execution once it’s done.</p>
<h3 id="statsrs"><a href="#statsrs"><code>stats.rs</code></a></h3>
<p>Defines a structure that gathers execution statistics.</p>
</div></details><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.start_execution_worker.html" title="fn massa_execution_worker::start_execution_worker">start_execution_worker</a></div><div class="desc docblock-short">Launches an execution worker thread and returns an <code>ExecutionManager</code> to interact with it</div></li></ul></section></div></main><div id="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="massa_execution_worker" data-themes="" data-resource-suffix="" data-rustdoc-version="1.69.0-nightly (d962ea578 2023-02-26)" data-search-js="search-14421e1532aead08.js" data-settings-js="settings-f0c5c39777a9a2f6.js" data-settings-css="settings-0bcba95ff279c1db.css" ></div></body></html>